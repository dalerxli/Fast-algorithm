
WARNING: Volume of the domain containing particles should be positive. Set the default value!
WARNING: Particle radius should be positive and less than the domain size. Set the default value!
WARNING: Distance between neighboring particles should be positive, greater than the radius of a particle, and less than the domain size. Set the default value!
WARNING: Original refraction should not be zero. Set the default value!
WARNING: Desired refraction should not be zero. Set the default value!
WARNING: Distribution of particles should be positive. Set the default value!
----------------------- SOLVING PARTICLE SCATTERING PROBLEM -----------------------

Speed of wave, v:					34400
Frequency, f:						1000
Wave number, k:						0.182651
Direction of plane wave, alpha:				(1, 0, 0)
Kappa:							0.5
Volume of the domain that contains all particles, |D|:	1
Original refraction coefficient, n0:			1+0i
Desired refraction coefficient, n:			-1+0.001i
Distribution of particles, N:				1
Boundary impedance, zeta:				5.52222e-06+0.0110444i
Radius of one particle, a:				2.311204e-07
Distance between two neighboring particles, d:		4.807498e-04
Number of particles, M:					9000000000 (8.999999e+09)
Number of sub cubes after partitioning the domain, P:	8000
Total collocation points for solving integral equation:	27000

Initializing done:	Mem used: 2.14344e+07 	Elapsed time:	0:0:0
Setting up FFT:		Mem used: 2.41254e+07 	Elapsed time:	0:0:0
Setting up RHS done:	Mem used: 2.49332e+08 	Elapsed time:	0:0:2

Computing:
Tolerance:	0.001
Method:		cg
Copy internal vector:	Mem used: 2.94728e+09 	Elapsed time:	0:1:7
Apply FFT:		Mem used: 2.95319e+09 	Elapsed time:	0:24:33
Pad Green cube:		Mem used: 4.76136e+09 	Elapsed time:	0:30:11
Multiply vectors:	Mem used: 4.76136e+09 	Elapsed time:	0:30:11
Apply iFFT:		Mem used: 2.96423e+09 	Elapsed time:	0:31:21
Copy internal vector:	Mem used: 6.11366e+09 	Elapsed time:	0:32:11
Assembly result:	Mem used: 2.9662e+09 	Elapsed time:	0:49:44

Solving the original linear system (FFT):
Norm of error:	1.48409
Iterations:	1
Elapsed time:	0:49:49

Solving the reduced linear system:
Norm of error:	0.00157248
Iterations:	1
Elapsed time:	0:49:50

Solving the integral equation:
Norm of error:	0.00297365
Iterations:	1
Elapsed time:	0:49:50

Comparing solutions:
(Original system)   vs (Reduced system):	5.28389e-05
(Integral equation) vs (Original system):	0.000886334
(Integral equation) vs (Reduced system):	0.0563096
(Original system)   vs (Incident field):	7.90885e-06

Started on:	Mon Apr 21 21:06:03 2014
Finished on:	Mon Apr 21 21:56:17 2014
Elapsed time:	0:50:14
