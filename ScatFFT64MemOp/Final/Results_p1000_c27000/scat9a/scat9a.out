
WARNING: Volume of the domain containing particles should be positive. Set the default value!
WARNING: Particle radius should be positive and less than the domain size. Set the default value!
WARNING: Distance between neighboring particles should be positive, greater than the radius of a particle, and less than the domain size. Set the default value!
WARNING: Original refraction should not be zero. Set the default value!
WARNING: Desired refraction should not be zero. Set the default value!
WARNING: Distribution of particles should be positive. Set the default value!
----------------------- SOLVING PARTICLE SCATTERING PROBLEM -----------------------

Speed of wave, v:					34400
Frequency, f:						1000
Wave number, k:						0.182651
Direction of plane wave, alpha:				(1, 0, 0)
Kappa:							0.5
Volume of the domain that contains all particles, |D|:	1
Original refraction coefficient, n0:			1+0i
Desired refraction coefficient, n:			-1+0.001i
Distribution of particles, N:				1
Boundary impedance, zeta:				2.65481e-06+0.00530961i
Radius of one particle, a:				1.000000e-06
Distance between two neighboring particles, d:		1.000000e-03
Number of particles, M:					1000000000 (1.000000e+09)
Number of sub cubes after partitioning the domain, P:	1000
Total collocation points for solving integral equation:	27000

Initializing done:	Mem used: 2.16842e+07 	Elapsed time:		0:0:1
Setting up FFT:		Mem used: 2.43958e+07 	Elapsed time:		0:0:1
Setting up RHS done:	Mem used: 8.7081e+07 	Elapsed time:		0:0:1

Computing:
Tolerance:	0.001
Method:		cg
Copy internal vector:	Mem used: 8.4797e+08 	Elapsed time:		0:0:2
Apply FFT:		Mem used: 8.54172e+08 	Elapsed time:		0:0:30
Pad Green cube:		Mem used: 1.37568e+09 	Elapsed time:		0:1:2
Multiply vectors:	Mem used: 1.37568e+09 	Elapsed time:		0:1:2
Apply iFFT:		Mem used: 8.65214e+08 	Elapsed time:		0:1:26
Copy internal vector:	Mem used: 1.76903e+09 	Elapsed time:		0:1:30
Assembly result:	Mem used: 8.67779e+08 	Elapsed time:		0:1:32

Solving the original linear system (FFT):
Norm of r=b-Ax:		0.639922
Relative error |r|/|b|:	2.02361e-05
Iterations:		1
Elapsed time:		0:1:36

Vector solution of the original linear system (FFT): Wrote to FFTx.bin

Solving the reduced linear system:
Norm of r=b-Ax:		4.12251e-05
Relative error |r|/|b|:	1.30365e-06
Iterations:		1
Elapsed time:		0:2:58

Vector Solution of the reduced linear system: Wrote to y.bin

Solving the integral equation:
Norm of r=b-Ax:		0.00022035
Relative error |r|/|b|:	1.34101e-06
Iterations:		1
Elapsed time:		0:2:59

Vector Solution of the integral equation: Wrote to z.bin

Comparing solutions:
(Original system)   vs (Reduced system):	0.00902326
(Integral equation) vs (Original system):	0.00290528
(Integral equation) vs (Reduced system):	0.0121767
(Original system)   vs (Incident field):	2.83671e-05

Started on:		Sun Jun  1 17:40:27 2014
Finished on:		Sun Jun  1 17:43:29 2014
Elapsed time:		0:3:2
